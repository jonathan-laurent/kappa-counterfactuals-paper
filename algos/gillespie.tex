\begin{algorithm}
\caption{Gillespie algorithm}\label{alg:gillespie}
\begin{spacing}{1.2}
\begin{algorithmic}
\vspace{0.2cm}
  \STATE $t \gets 0$
  \STATE $M \gets\ $ initial mixture
  \WHILE{ $t < t_\text{\,end}$ }
      \STATE $\alpha \gets \sum_r {\lambda_r |\EMBS{r}{M}|}$
      \STATE draw $\delta \sim \textsc{Exp}(\alpha) $
      \STATE $t \gets t + \delta$
      \STATE draw a rule $r$ with probability
      $\propto \ \lambda_r |\EMBS{r}{M}|$

      \STATE draw an embedding $\xi$ uniformly in $\EMBS{r}{M}$
      \STATE update $M$ by triggering event $(r, \xi)$
  \ENDWHILE
\vspace{0.1cm}
\end{algorithmic}
\end{spacing}
\end{algorithm}